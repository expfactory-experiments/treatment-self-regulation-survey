<!DOCTYPE html><html class=''>
<head>
    <meta charset='UTF-8'>
    <meta name="robots" content="noindex">
    <title>The Experiment Factory: Survey</title>
    
    <link rel='stylesheet' type='text/css' href='css/material.blue-red.min.css'>
    <link rel='stylesheet' type='text/css' href='css/surveys.css'>
    <link rel='stylesheet' type='text/css' href='css/jquery-ui-1.10.4.custom.min.css'>
    <link rel='stylesheet' type='text/css' href='css/style.css'>
</head>

<body>

    <script src='js/jquery-2.1.1.min.js'></script>
    <script src='js/material.min.js'></script>
    <script src='js/jquery-ui-1.10.4.custom.min.js'></script>
    <script src='js/jquery.wizard.js'></script>
    <script src='js/jquery.form-3.50.js'></script>
    <script src='js/jquery.validate-1.12.0.min.js'></script>

<div class="experiment-layout mdl-layout mdl-layout--fixed-header mdl-js-layout mdl-color--grey-100">
<div class="experiment-ribbon"></div>
<main class="experiment-main mdl-layout__content">
<div class="experiment-container mdl-grid">
<div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone">
</div>
<div class="experiment-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col">

<div id="questions">

<form name="questions" action="#", method="POST">
<div class="step">
<h3>Welcome to this survey. Press <strong>Next</strong> to begin.</h3><br><br><br><br></div>
<div class="step">
<h3>The following question relates to the reasons why you would seek treatment. Different people have different reasons for doing that, and we want to know how true each of the following reasons is for you. All 15 response are to the same question.</h3><br><br><br><br></div>
<div class="step">
<h3>Please indicate the extent to which each reason is true for you.</h3><br><br><br><br>
<p id="treatment-self-regulation-survey_3_options">Because I feel that I want to take responsibility for my own health</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_3_0">
<input type="radio" id="option-treatment-self-regulation-survey_3_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_3_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I feel that I want to take responsibility for my own health">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_3_1">
<input type="radio" id="option-treatment-self-regulation-survey_3_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_3_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I feel that I want to take responsibility for my own health">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_3_2">
<input type="radio" id="option-treatment-self-regulation-survey_3_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_3_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I feel that I want to take responsibility for my own health">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_4_options">Because I would feel guilty or ashamed of myself if I engaged in this behavior</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_4_0">
<input type="radio" id="option-treatment-self-regulation-survey_4_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_4_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I would feel guilty or ashamed of myself if I engaged in this behavior">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_4_1">
<input type="radio" id="option-treatment-self-regulation-survey_4_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_4_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I would feel guilty or ashamed of myself if I engaged in this behavior">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_4_2">
<input type="radio" id="option-treatment-self-regulation-survey_4_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_4_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I would feel guilty or ashamed of myself if I engaged in this behavior">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_5_options">Because I personally believe it is the best thing for my health</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_5_0">
<input type="radio" id="option-treatment-self-regulation-survey_5_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_5_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I personally believe it is the best thing for my health">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_5_1">
<input type="radio" id="option-treatment-self-regulation-survey_5_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_5_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I personally believe it is the best thing for my health">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_5_2">
<input type="radio" id="option-treatment-self-regulation-survey_5_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_5_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I personally believe it is the best thing for my health">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_6_options">Because others would be upset with me if I engaged in this behavior</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_6_0">
<input type="radio" id="option-treatment-self-regulation-survey_6_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_6_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because others would be upset with me if I engaged in this behavior">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_6_1">
<input type="radio" id="option-treatment-self-regulation-survey_6_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_6_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because others would be upset with me if I engaged in this behavior">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_6_2">
<input type="radio" id="option-treatment-self-regulation-survey_6_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_6_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because others would be upset with me if I engaged in this behavior">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_7_options">I really don't think about it</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_7_0">
<input type="radio" id="option-treatment-self-regulation-survey_7_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_7_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="I really don't think about it">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_7_1">
<input type="radio" id="option-treatment-self-regulation-survey_7_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_7_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="I really don't think about it">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_7_2">
<input type="radio" id="option-treatment-self-regulation-survey_7_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_7_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="I really don't think about it">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_8_options">Because I have carefully thought about it and believe it is very important for many aspects of my life</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_8_0">
<input type="radio" id="option-treatment-self-regulation-survey_8_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_8_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I have carefully thought about it and believe it is very important for many aspects of my life">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_8_1">
<input type="radio" id="option-treatment-self-regulation-survey_8_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_8_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I have carefully thought about it and believe it is very important for many aspects of my life">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_8_2">
<input type="radio" id="option-treatment-self-regulation-survey_8_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_8_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I have carefully thought about it and believe it is very important for many aspects of my life">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_9_options">Because I would feel bad about myself if I engaged in this behavior</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_9_0">
<input type="radio" id="option-treatment-self-regulation-survey_9_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_9_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I would feel bad about myself if I engaged in this behavior">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_9_1">
<input type="radio" id="option-treatment-self-regulation-survey_9_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_9_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I would feel bad about myself if I engaged in this behavior">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_9_2">
<input type="radio" id="option-treatment-self-regulation-survey_9_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_9_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I would feel bad about myself if I engaged in this behavior">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_10_options">Because it is an important choice I really want to make</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_10_0">
<input type="radio" id="option-treatment-self-regulation-survey_10_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_10_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is an important choice I really want to make">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_10_1">
<input type="radio" id="option-treatment-self-regulation-survey_10_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_10_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is an important choice I really want to make">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_10_2">
<input type="radio" id="option-treatment-self-regulation-survey_10_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_10_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is an important choice I really want to make">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_11_options">Because I feel pressure from others to not engage in this behavior</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_11_0">
<input type="radio" id="option-treatment-self-regulation-survey_11_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_11_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I feel pressure from others to not engage in this behavior">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_11_1">
<input type="radio" id="option-treatment-self-regulation-survey_11_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_11_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I feel pressure from others to not engage in this behavior">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_11_2">
<input type="radio" id="option-treatment-self-regulation-survey_11_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_11_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I feel pressure from others to not engage in this behavior">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_12_options">Because it is easier to do what I am told than to think about it</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_12_0">
<input type="radio" id="option-treatment-self-regulation-survey_12_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_12_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is easier to do what I am told than to think about it">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_12_1">
<input type="radio" id="option-treatment-self-regulation-survey_12_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_12_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is easier to do what I am told than to think about it">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_12_2">
<input type="radio" id="option-treatment-self-regulation-survey_12_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_12_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is easier to do what I am told than to think about it">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_13_options">Because it is consistent with my life goals</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_13_0">
<input type="radio" id="option-treatment-self-regulation-survey_13_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_13_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is consistent with my life goals">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_13_1">
<input type="radio" id="option-treatment-self-regulation-survey_13_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_13_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is consistent with my life goals">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_13_2">
<input type="radio" id="option-treatment-self-regulation-survey_13_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_13_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is consistent with my life goals">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_14_options">Because I want others to approve of me</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_14_0">
<input type="radio" id="option-treatment-self-regulation-survey_14_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_14_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I want others to approve of me">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_14_1">
<input type="radio" id="option-treatment-self-regulation-survey_14_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_14_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I want others to approve of me">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_14_2">
<input type="radio" id="option-treatment-self-regulation-survey_14_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_14_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I want others to approve of me">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_15_options">Because it is very important for being as healthy as possible</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_15_0">
<input type="radio" id="option-treatment-self-regulation-survey_15_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_15_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is very important for being as healthy as possible">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_15_1">
<input type="radio" id="option-treatment-self-regulation-survey_15_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_15_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is very important for being as healthy as possible">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_15_2">
<input type="radio" id="option-treatment-self-regulation-survey_15_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_15_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because it is very important for being as healthy as possible">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_16_options">Because I want others to see that I can do it</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_16_0">
<input type="radio" id="option-treatment-self-regulation-survey_16_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_16_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I want others to see that I can do it">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_16_1">
<input type="radio" id="option-treatment-self-regulation-survey_16_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_16_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I want others to see that I can do it">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_16_2">
<input type="radio" id="option-treatment-self-regulation-survey_16_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_16_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="Because I want others to see that I can do it">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br>
<p id="treatment-self-regulation-survey_17_options">I don't really know why</p>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_17_0">
<input type="radio" id="option-treatment-self-regulation-survey_17_0" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_17_options" value="1" meta-options="Not at all true|Somewhat true|Very True" meta-text="I don't really know why">
<span class="mdl-radio__label">Not at all true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_17_1">
<input type="radio" id="option-treatment-self-regulation-survey_17_1" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_17_options" value="2" meta-options="Not at all true|Somewhat true|Very True" meta-text="I don't really know why">
<span class="mdl-radio__label">Somewhat true</span>
</label>
<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-treatment-self-regulation-survey_17_2">
<input type="radio" id="option-treatment-self-regulation-survey_17_2" class="mdl-radio__button required page3" name="treatment-self-regulation-survey_17_options" value="3" meta-options="Not at all true|Somewhat true|Very True" meta-text="I don't really know why">
<span class="mdl-radio__label">Very True</span>
</label><br><br><br><br></div>
<div class="step">
<h3>Congratulations for completing this survey! Press <strong>finish</strong> to continue.</h3><br><br><br><br></div>

<div class="navigation">
    <ul class="clearfix">
        <li><button type="button" 
                    name="backward" 
                    class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent backward">Previous</button></li>
	<li><button type="button" 
                    name="forward" 
                    class="forward mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">Next</button></li>
        <li><button type="submit" 
                    name="process" 
                    class="submit mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">Finish</button></li>
    </ul>
</div>

<div class="pad">
    <div id="progressbar"></div>
</div>
</form>
</div>

<script>
$( document ).ready(function() {

    expfactory_finished = false;

    // Basic wizard with progress bar
    $( "#progressbar" ).progressbar();
    $( "#questions" ).wizard({
        stepsWrapper: "#wrapped",
	submit: ".submit",
	beforeForward: function( event, state ) {

            // Function to add message that answer is required
            function is_required(elements){
                var missing = false;
                elements.each(function(index,element){
                    var pid = "#" + $(element).attr("name")
                    $(pid).css("color","red")
                    missing = true;                   
                });

                if (missing == true){
                   alert("Please answer all required questions in red.");
                }
            }

             if ( state.stepIndex === 3 ) {
 if (($.unique($(`.page3.required[type=number],.page3.required:text`).map(function(){return $(this).attr(`meta-text`)})).map(function() {return $(`[meta-text*="` + this + `"].required[type=number], [meta-text*="` + this + `"].required:text`).filter(function() { return $(this).val();}).length > 0}).get().indexOf(false) != -1) || ($.unique($(`.page3.required:not([type=number]):not(:text)`).map(function(){return $(this).attr(`meta-text`)})).map(function() {return $(`[meta-text*="` + this + `"].required:checked`).length > 0}).get().indexOf(false) != -1)){
is_required($(`.page3.required:not(checked)`));
return false;
 } else {
expfactory_finished=true;
}}

	    return !!$( this ).wizard( "form" ).valid();
        },
	afterSelect: function( event, state ) {
	    $( "#progressbar" ).progressbar( "value", state.percentComplete );
            if (expfactory_finished == true){
                $(".submit").enable();
            }
        }

    // Form submission
    }).wizard( "form" ).submit(function( event ) {

        event.preventDefault();
        
        var $inputs = $("input:checked");
        var $text = $("input:text")
        var $number = $("input[type = number]")
        var $elements = $inputs.add($text).add($number)
        
        // Prepare data results
        var results = []
        $elements.each(function(index, element) {
            var result = {}

            if ($.inArray( $(element).attr("name"), [ "forward", "backward", "process"] ) == -1) {
                result.name = $(element).attr("name");
                if ($(element).attr("value") == undefined) {
                    result.value = $(element).val();
                } else {
                    result.value = $(element).attr("value");
                }
                result.options = $(element).attr("meta-options");
                result.text = $(element).attr("meta-text");
                results.push(result);
             }
        })

        
        $.ajax({

                type: 'POST',
                url: '/save',
                data: {'data': results},

                success: function() {
                    console.log('success');
                    document.location = '/next'
                 },

                 // Endpoint not running, local save
                 error: function(err) {

                     if (err.status == 200) {
                        document.location = '/next'
                     }        
        
                     console.log("Error with POST" + err.status + ", downloading to local file.")
                     // Save data to browser

                     var data = "text/json;charset=utf-8," + JSON.stringify(results);
                     var a = document.createElement('a');
                     a.title = "Download"
                     a.id = "download"
                     a.type = "button"
                     a.download = 'treatment-self-regulation-survey_result.json';
                     a.href = 'data:' + data;
                     $(".submit").html("Download")
                     $(".submit").click(function(){
                         $("body").append(a)
                         a.click()
                     })

                  }
         });

     // Validation
     }).validate({
	errorPlacement: function( error, element ) {
	    if ( element.is( ":radio" ) || element.is( ":checkbox" ) ) {
		error.insertBefore( element.next() );
            } else {
	        error.insertAfter( element );
	 }
      }
  });
});
</script>
</body>
</html>
